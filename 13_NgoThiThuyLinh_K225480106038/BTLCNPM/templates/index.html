<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Äáº·t VÃ© TÃ u Online</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>

<header class="header">
    <div class="logo">ğŸš† Äáº·t VÃ© TÃ u Online</div>
    <nav class="nav">
        <a href="#" onclick="showBooking()">Trang chá»§</a>
        <a href="#" onclick="showBooking()">Äáº·t vÃ©</a>
        <a href="#" onclick="showHistory()">Lá»‹ch sá»­</a>
        <a href="/logout">ÄÄƒng xuáº¥t</a>
    </nav>
</header>

<section class="banner">
    <div class="banner-text">
        <h1>Há»‡ thá»‘ng Ä‘áº·t vÃ© tÃ u nhanh chÃ³ng & tiá»‡n lá»£i</h1>
        <p>Chá»n tuyáº¿n â€“ Chá»n chuyáº¿n â€“ Nháº­n vÃ© ngay!</p>
        <button onclick="scrollToForm()">Äáº·t vÃ© ngay</button>
    </div>
</section>

<!-- HIá»‚N THá»Š THÃ”NG BÃO FLASH -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-container">
      {% for category, message in messages %}
        <div class="flash-message {{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<!-- PHáº¦N Äáº¶T VÃ‰ -->
<section class="booking-section" id="bookingSection">
    <h2>ThÃ´ng tin Ä‘áº·t vÃ©</h2>

    <form class="booking-form" action="/datve" method="POST">
        <div class="form-group">
            <label>Tuyáº¿n Ä‘Æ°á»ng</label>
            <select id="selectTuyen" name="tuyen_duong" required>
                <option value="">-- Äang táº£i dá»¯ liá»‡u... --</option>
            </select>
        </div>

        <div class="form-group">
            <label>Chuyáº¿n tÃ u</label>
            <select id="selectLichTrinh" name="ma_lich_trinh" required>
                <option value="">-- Chá»n tuyáº¿n trÆ°á»›c --</option>
            </select>
        </div>

        <div class="form-group">
            <label>GiÃ¡ vÃ©</label>
            <input type="text" id="giaVe" name="gia" readonly placeholder="HÃ£y chá»n chuyáº¿n...">
        </div>

        <button class="submit-btn" type="submit">XÃ¡c nháº­n Ä‘áº·t vÃ©</button>
    </form>
</section>

<!-- PHáº¦N Lá»ŠCH Sá»¬ -->
<section class="history-section hidden" id="historySection">
    <h2>Lá»‹ch sá»­ Ä‘áº·t vÃ© cá»§a báº¡n</h2>

    {% if lichsu and lichsu|length > 0 %}
    <div class="ticket-list">
        {% for v in lichsu %}
        <div class="ticket-card">
            <div class="ticket-header">
                <span class="ticket-id">MÃ£ Ä‘áº·t vÃ©: {{ v.MaDatVe }}</span>

                {% if v.DaHuy == 1 %}
                    <span class="ticket-status danger">ÄÃ£ há»§y</span>
                {% elif v.ThanhToan == 'ÄÃ£ thanh toÃ¡n' or v.TrangThai == 'ÄÃ£ thanh toÃ¡n' %}
                    <span class="ticket-status success">ÄÃ£ thanh toÃ¡n</span>
                {% else %}
                    <span class="ticket-status warning">{{ v.TrangThai }}</span>
                {% endif %}
            </div>

            <div class="ticket-body">
                <p><strong>Sá»‘ gháº¿:</strong> {{ v.SoGhe if v.SoGhe else "ChÆ°a cÃ³" }}</p>
                <p><strong>GiÃ¡ vÃ©:</strong> {{ v.GiaVe }} VND</p>
                <p><strong>NgÃ y Ä‘áº·t:</strong> {{ v.NgayTao }}</p>

                <div class="ticket-actions">
                    {% if v.DaHuy == 0 %}
                        {% if v.ThanhToan != 'ÄÃ£ thanh toÃ¡n' %}
                            <button onclick="thanhToan('{{ v.MaDatVe }}')" class="pay-btn">Thanh toÃ¡n</button>
                        {% endif %}
                        <button onclick="huyVe('{{ v.MaDatVe }}')" class="cancel-btn">Há»§y vÃ©</button>
                    {% endif %}
                </div>
            </div>

        </div>
        {% endfor %}
    </div>
    {% else %}
        <p>âš  Báº¡n chÆ°a Ä‘áº·t vÃ© nÃ o.</p>
    {% endif %}
</section>

<footer class="footer">
    Â© 2025 â€“ Há»‡ thá»‘ng Ä‘áº·t vÃ© tÃ u online | Thiáº¿t káº¿ bá»Ÿi Linh Nguyen
</footer>

<script src="/static/script.js"></script>

</body>
</html>
